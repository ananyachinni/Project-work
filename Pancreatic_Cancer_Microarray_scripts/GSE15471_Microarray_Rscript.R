#Pancreatic Cancer Microarray Data Analysis
#GSE15471
setwd("C:/gse15471")
celpath = "C:/gse15471"
library(affy)
data = ReadAffy(celfile.path = celpath) #Reading in the .CEL files
ph = data@phenoData
#ph
feat = data@featureData
feat@data
exp = data@experimentData
#exp
ph@data [ ,1] = c("control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", 
                  "control", "control", "control", "control", "control", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", 
                  "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant")
ph@data
name = "boxplot.jpg"          #Boxplot before normalization
jpeg(name)
boxplot(data,which='pm',col='red',names=ph@data$sample,xlab='Samplename',ylab='logInt') 
dev.off()
data.rma = rma(data)
data.matrix = exprs(data.rma)
name = "boxplotnorm.jpg" #Boxplot after normalization
jpeg(name)
boxplot(data.matrix,col='red',names=ph@data$sample,lab='Samplename',ylab='logInt')
dev.off()
for (i in 1:78)                    #MA plot for all samples before normalization
   {
         name = paste("MAplot",i,".jpg",sep="")
         jpeg(name)
         MAplot(data,which=i)
         dev.off()
         }
library(oligo)
for (i in 1:78)                   #MA plot for all samples after normalization
   {
         name = paste("MAplotnorm",i,".jpg",sep="")
         jpeg(name)
         MAplot(data.rma,which=i)
         dev.off()
         }
data.matrix = exprs(data.rma)
ph@data [ ,2] = c("control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", 
                  "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", 
                  "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", "control", 
                  "control", "control", "control", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", 
                  "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", 
                  "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", "mutant", 
                  "mutant", "mutant", "mutant")
colnames(ph@data)[2]="source"
ph@data
groups = ph@data$source
f = factor(groups,levels=c("control","mutant"))
design = model.matrix(~ 0 + f)
colnames(design) = c("control","mutant")
library(limma)
data.fit = lmFit(data.matrix,design)
contrast.matrix = makeContrasts(mutant-control,levels=design)
data.fit.con = contrasts.fit(data.fit,contrast.matrix)
data.fit.eb = eBayes(data.fit.con)
volcanoplot(data.fit.eb, coef = 1L, style = "p-value", highlight = 10, names = ph@data$source, main = "Volcano plot", xlab = "Log2 Fold Change", ylab = "-log10Pvalue", pch=16, cex=0.35)
lp <- -log10(data.fit.eb$p.value[,1])
ord <- order(lp, decreasing = TRUE)[1:500]
points(data.fit.eb$coef[ord,1], lp[ord], pch = 16, cex = 0.45, col = 2)
options(digits = 2)
tab = topTable(data.fit.eb,coef=1,number=4000,adjust.method="BH") #Using topTable for extracting differentially expressed probes
topgenes = tab[tab[, "adj.P.Val"] < 0.05, ]
topups = topgenes[topgenes[, "logFC"] > 1, ]
topdowns = topgenes[topgenes[, "logFC"] < -1, ]
IDs.up = rownames(topups)
IDs.down = rownames(topdowns)
write.table(IDs.up,row.names=FALSE,col.names=FALSE,quote=FALSE,file="C:/gse15471/upIDs.txt")
write.table(IDs.down,row.names=FALSE,col.names=FALSE,quote=FALSE,file="C:/gse15471/downIDs.txt")
library(biomaRt)
listMarts()
ensembl = useMart("ensembl",dataset="hsapiens_gene_ensembl")
affyids = c("212344_at" ,"212354_at" ,"212353_at" ,"227140_at" ,"217428_s_at" ,"210511_s_at" ,"226237_at" ,"227566_at" ,"210495_x_at" ,"205941_s_at" ,"219773_at" ,"212464_s_at" ,"216442_x_at" ,"204619_s_at"
              ,"211719_x_at" ,"203083_at" ,"204620_s_at" ,"226997_at" ,"211571_s_at" ,"225681_at" ,"221731_x_at" ,"215646_s_at" ,"241473_at" ,"222810_s_at" ,"201850_at" ,"209955_s_at" ,"201792_at" ,"202404_s_at" ,"202310_s_at"
              ,"229802_at" ,"241872_at" ,"201666_at" ,"229218_at" ,"221729_at" ,"1568619_s_at" ,"202729_s_at" ,"205499_at" ,"224694_at" ,"203570_at" ,"222449_at" ,"202403_s_at" ,"212488_at" ,"211864_s_at" ,"219179_at"
              ,"227792_at" ,"227276_at" ,"226311_at" ,"238617_at" ,"238455_at" ,"203476_at" ,"202311_s_at" ,"221730_at" ,"232458_at" ,"204463_s_at" ,"236297_at" ,"201438_at" ,"1555778_a_at" ,"201125_s_at" ,"212489_at"
              ,"37892_at" ,"235629_at" ,"201261_x_at" ,"212399_s_at" ,"218804_at" ,"203325_s_at" ,"229459_at" ,"211959_at" ,"201852_x_at" ,"201798_s_at" ,"210809_s_at" ,"224817_at" ,"203417_at" ,"235821_at" ,"215076_s_at"
              ,"208540_x_at" ,"213422_s_at" ,"216235_s_at" ,"210220_at" ,"213869_x_at" ,"226609_at" ,"214587_at" ,"205713_s_at" ,"200660_at" ,"230493_at" ,"208850_s_at" ,"235296_at" ,"201310_s_at" ,"207172_s_at" ,"228141_at"
              ,"229479_at" ,"209360_s_at" ,"242979_at" ,"213125_at" ,"228933_at" ,"202363_at" ,"203021_at" ,"204320_at" ,"211161_s_at" ,"213905_x_at" ,"228754_at" ,"218051_s_at" ,"227314_at" ,"202728_s_at" ,"203238_s_at"
              ,"227036_at" ,"229553_at" ,"204686_at" ,"207173_x_at" ,"202273_at" ,"204464_s_at" ,"1556499_s_at" ,"209596_at" ,"214247_s_at" ,"218638_s_at" ,"217763_s_at" ,"210605_s_at" ,"202145_at" ,"223095_at" ,"212473_s_at"
              ,"221911_at" ,"225803_at" ,"57588_at" ,"219090_at" ,"229256_at" ,"200665_s_at" ,"210004_at" ,"201042_at" ,"228904_at" ,"217762_s_at" ,"208636_at" ,"219725_at" ,"207191_s_at" ,"209016_s_at" ,"229554_at"
              ,"214807_at" ,"207714_s_at" ,"204345_at" ,"219700_at" ,"211958_at" ,"228481_at" ,"201416_at" ,"212444_at" ,"213503_x_at" ,"202267_at" ,"225731_at" ,"208816_x_at" ,"203108_at" ,"217764_s_at" ,"226552_at"
              ,"208637_x_at" ,"226930_at" ,"221900_at" ,"210427_x_at" ,"201069_at" ,"212992_at" ,"203700_s_at" ,"231240_at" ,"202450_s_at" ,"214702_at" ,"223278_at" ,"205422_s_at" ,"226865_at" ,"203935_at" ,"214927_at"
              ,"206224_at" ,"201874_at" ,"201590_x_at" ,"1554018_at" ,"224952_at" ,"223378_at" ,"224002_s_at" ,"225735_at" ,"218856_at" ,"207426_s_at" ,"219479_at" ,"208851_s_at" ,"227628_at" ,"212236_x_at" ,"205206_at"
              ,"222020_s_at" ,"231807_at" ,"202196_s_at" ,"206571_s_at" ,"236114_at" ,"201141_at" ,"229991_s_at" ,"229635_at" ,"216973_s_at" ,"205453_at" ,"201251_at" ,"1554474_a_at" ,"232568_at" ,"230424_at" ,"201309_x_at"
              ,"211597_s_at" ,"212143_s_at" ,"205542_at" ,"224733_at" ,"221872_at" ,"210095_s_at" ,"209012_at" ,"235521_at" ,"221898_at" ,"221127_s_at" ,"204589_at" ,"226695_at" ,"203989_x_at" ,"220092_s_at" ,"200755_s_at"
              ,"219463_at" ,"227070_at" ,"206392_s_at" ,"1561689_at" ,"219087_at" ,"219901_at" ,"204779_s_at" ,"219315_s_at" ,"226885_at" ,"209218_at" ,"201262_s_at" ,"226884_at" ,"222108_at" ,"201417_at" ,"226726_at"
              ,"209708_at" ,"205032_at" ,"225664_at" ,"203835_at" ,"211981_at" ,"209803_s_at" ,"223121_s_at" ,"205308_at" ,"202766_s_at" ,"218788_s_at" ,"222235_s_at" ,"1557080_s_at" ,"227995_at" ,"201655_s_at" ,"215446_s_at"
              ,"224911_s_at" ,"37408_at" ,"204051_s_at" ,"203072_at" ,"209446_s_at" ,"218729_at" ,"225776_at" ,"225328_at" ,"206414_s_at" ,"203313_s_at" ,"241808_at" ,"212202_s_at" ,"211964_at" ,"201105_at" ,"217728_at"
              ,"204682_at" ,"218181_s_at" ,"224396_s_at" ,"211160_x_at" ,"244420_at" ,"214581_x_at" ,"227415_at" ,"201185_at" ,"212985_at" ,"231823_s_at" ,"220617_s_at" ,"231993_at" ,"203789_s_at" ,"209386_at" ,"201548_s_at"
              ,"220014_at" ,"226364_at" ,"211980_at" ,"220230_s_at" ,"226545_at" ,"241780_at" ,"231579_s_at" ,"212667_at" ,"227966_s_at" ,"201431_s_at" ,"223451_s_at" ,"227041_at" ,"218718_at" ,"224560_at" ,"203878_s_at"
              ,"226899_at" ,"201430_s_at" ,"203370_s_at" ,"236179_at" ,"211966_at" ,"218871_x_at" ,"209935_at" ,"205120_s_at" ,"225021_at" ,"1555137_a_at" ,"213419_at" ,"238852_at" ,"205582_s_at" ,"231766_s_at" ,"206796_at"
              ,"212104_s_at" ,"206391_at" ,"205404_at" ,"201860_s_at" ,"202856_s_at" ,"1555705_a_at" ,"224937_at" ,"200986_at" ,"217875_s_at" ,"212067_s_at" ,"204932_at" ,"1561180_at" ,"208747_s_at" ,"223499_at" ,"217388_s_at"
              ,"202765_s_at" ,"201124_at" ,"220750_s_at" ,"225303_at" ,"222450_at" ,"212746_s_at" ,"235834_at" ,"202141_s_at" ,"1553530_a_at" ,"210845_s_at" ,"212666_at" ,"213252_at" ,"221058_s_at" ,"200907_s_at" ,"205890_s_at"
              ,"231130_at" ,"216194_s_at" ,"211709_s_at" ,"200661_at" ,"236044_at" ,"202439_s_at" ,"201162_at" ,"228088_at" ,"202351_at" ,"201341_at" ,"227889_at" ,"239286_at" ,"211668_s_at" ,"207233_s_at" ,"202096_s_at"
              ,"202820_at" ,"213910_at" ,"204052_s_at" ,"208083_s_at" ,"225406_at" ,"224710_at" ,"207719_x_at" ,"222719_s_at" ,"221447_s_at" ,"1559529_at" ,"205991_s_at" ,"225481_at" ,"232476_at" ,"219922_s_at" ,"241762_at"
              ,"205479_s_at" ,"217591_at" ,"1555630_a_at" ,"234994_at" ,"225799_at" ,"223279_s_at" ,"211429_s_at" ,"202237_at" ,"226777_at" ,"225275_at" ,"201650_at" ,"202381_at" ,"214974_x_at" ,"223690_at" ,"223854_at"
              ,"218502_s_at" ,"1556656_at" ,"209365_s_at" ,"226000_at" ,"202771_at" ,"214081_at" ,"240370_at" ,"235318_at" ,"201005_at" ,"201170_s_at" ,"235371_at" ,"211945_s_at" ,"228461_at" ,"242397_at" ,"218983_at"
              ,"206026_s_at" ,"209344_at" ,"242625_at" ,"223672_at" ,"1557527_at" ,"204451_at" ,"205068_s_at" ,"215034_s_at" ,"231879_at" ,"1553678_a_at" ,"205425_at" ,"217733_s_at" ,"225464_at" ,"238481_at" ,"235008_at"
              ,"1557049_at" ,"1558199_at" ,"226535_at" ,"224793_s_at" ,"1569150_x_at" ,"208782_at" ,"211651_s_at" ,"209205_s_at" ,"213338_at" ,"238478_at" ,"200906_s_at" ,"233814_at" ,"203699_s_at" ,"200872_at" ,"216971_s_at"
              ,"227576_at" ,"211924_s_at" ,"223454_at" ,"204259_at" ,"233364_s_at" ,"47550_at" ,"203607_at" ,"226722_at" ,"205525_at" ,"203303_at" ,"214806_at" ,"202238_s_at" ,"201744_s_at" ,"206025_s_at" ,"204944_at"
              ,"214454_at" ,"204140_at" ,"235392_at" ,"233036_at" ,"232113_at" ,"201147_s_at" ,"225144_at" ,"233090_at" ,"204351_at" ,"219631_at" ,"235616_at" ,"204174_at" ,"227713_at" ,"209598_at" ,"232231_at" ,"202827_s_at"
              ,"230722_at" ,"225295_at" ,"201063_at" ,"202834_at" ,"1569149_at" ,"201505_at" ,"213275_x_at" ,"225566_at" ,"209684_at" ,"207034_s_at" ,"213518_at" ,"226763_at" ,"209156_s_at" ,"223463_at" ,"200897_s_at"
              ,"201201_at" ,"236429_at" ,"225946_at" ,"202465_at" ,"212687_at" ,"224724_at" ,"220272_at" ,"240432_x_at" ,"224218_s_at" ,"213288_at" ,"201616_s_at" ,"229491_at" ,"219249_s_at" ,"236764_at" ,"212472_at"
              ,"211564_s_at" ,"203561_at" ,"214453_s_at" ,"242052_at" ,"1557432_at" ,"203767_s_at" ,"204163_at" ,"222288_at" ,"226425_at" ,"209473_at" ,"1556055_at" ,"226621_at" ,"219890_at" ,"204725_s_at" ,"227955_s_at"
              ,"213703_at" ,"224895_at" ,"235286_at" ,"204114_at" ,"226065_at" ,"223158_s_at" ,"214830_at" ,"209655_s_at" ,"235705_at" ,"205376_at" ,"223122_s_at" ,"221752_at" ,"218273_s_at" ,"218963_s_at" ,"212077_at"
              ,"213274_s_at" ,"205003_at" ,"226372_at" ,"219787_s_at" ,"224252_s_at" ,"226658_at" ,"202833_s_at" ,"1555326_a_at" ,"221011_s_at" ,"225008_at" ,"61734_at" ,"221558_s_at" ,"1556051_a_at" ,"206580_s_at" ,"40148_at"
              ,"219161_s_at" ,"235606_at" ,"202478_at" ,"209356_x_at" ,"204933_s_at" ,"201020_at" ,"217118_s_at" ,"202458_at" ,"227051_at" ,"226066_at" ,"1555420_a_at" ,"214701_s_at" ,"204700_x_at" ,"213668_s_at" ,"201508_at"
              ,"225524_at" ,"217795_s_at" ,"202806_at" ,"227961_at" ,"218084_x_at" ,"202504_at" ,"205780_at" ,"209474_s_at" ,"206335_at" ,"236215_at" ,"209546_s_at" ,"223204_at" ,"217226_s_at" ,"205227_at" ,"208659_at"
              ,"219892_at" ,"204334_at" ,"228080_at" ,"235074_at" ,"229202_at" ,"205483_s_at" ,"224940_s_at" ,"238623_at" ,"206448_at" ,"201617_x_at" ,"222547_at" ,"203780_at" ,"1567107_s_at" ,"212481_s_at" ,"242418_at"
              ,"212203_x_at" ,"202949_s_at" ,"241769_at" ,"237094_at" ,"243252_at" ,"231964_at" ,"215388_s_at" ,"204602_at" ,"230147_at" ,"225227_at" ,"226282_at" ,"208555_x_at" ,"202859_x_at" ,"211063_s_at" ,"200697_at"
              ,"203336_s_at" ,"222344_at" ,"1555997_s_at" ,"218093_s_at" ,"240868_at" ,"226084_at" ,"227059_at" ,"235944_at" ,"212764_at" ,"202951_at" ,"217767_at" ,"203232_s_at" ,"228628_at" ,"229795_at" ,"228128_x_at"
              ,"226869_at" ,"221538_s_at" ,"240502_at" ,"1558732_at" ,"209118_s_at" ,"226421_at" ,"232090_at" ,"235182_at" ,"204137_at" ,"233555_s_at" ,"200736_s_at" ,"208611_s_at" ,"218224_at" ,"215077_at" ,"217196_s_at"
              ,"228573_at" ,"214059_at" ,"201313_at" ,"37005_at" ,"200771_at" ,"244579_at" ,"203695_s_at" ,"207691_x_at" ,"225710_at" ,"212765_at" ,"200839_s_at" ,"229764_at" ,"226873_at" ,"211714_x_at" ,"200989_at"
              ,"212423_at" ,"221489_s_at" ,"205330_at" ,"227300_at" ,"226632_at" ,"231822_at" ,"228640_at" ,"1556423_at" ,"219073_s_at" ,"205122_at" ,"201506_at" ,"223730_at" ,"201037_at" ,"225847_at" ,"213923_at"
              ,"202855_s_at" ,"202934_at" ,"209387_s_at" ,"201169_s_at" ,"213194_at" ,"202679_at" ,"201935_s_at" ,"201340_s_at" ,"213857_s_at" ,"228617_at" ,"212233_at" ,"208131_s_at" ,"209792_s_at" ,"212792_at" ,"230906_at"
              ,"201641_at" ,"205174_s_at" ,"200923_at" ,"229669_at" ,"226676_at" ,"214511_x_at" ,"223220_s_at" ,"204702_s_at" ,"204439_at" ,"221530_s_at" ,"205618_at" ,"226604_at" ,"214770_at" ,"202357_s_at" ,"224941_at"
              ,"1557079_at" ,"215199_at" ,"200838_at" ,"206994_at" ,"212136_at" ,"235457_at" ,"226576_at" ,"205529_s_at" ,"230071_at" ,"209651_at" ,"202619_s_at" ,"202206_at" ,"201621_at" ,"206858_s_at" ,"230175_s_at"
              ,"33323_r_at" ,"236561_at" ,"215464_s_at" ,"225871_at" ,"211071_s_at" ,"204879_at" ,"224894_at" ,"225381_at" ,"213680_at" ,"201012_at" ,"228280_at" ,"209198_s_at" ,"232095_at" ,"224596_at" ,"223475_at"
              ,"201887_at" ,"203186_s_at" ,"201307_at" ,"202207_at" ,"206091_at" ,"222760_at" ,"205466_s_at" ,"235733_at" ,"209154_at" ,"205157_s_at" ,"238577_s_at" ,"209621_s_at" ,"223586_at" ,"209678_s_at" ,"201215_at"
              ,"33322_i_at" ,"226799_at" ,"215198_s_at" ,"209251_x_at" ,"226184_at" ,"219795_at" ,"209875_s_at" ,"202998_s_at" ,"224996_at" ,"223047_at" ,"232584_at" ,"243940_at" ,"223082_at" ,"211750_x_at" ,"205234_at"
              ,"202370_s_at" ,"221814_at" ,"202411_at" ,"212895_s_at" ,"209524_at" ,"232453_at" ,"214844_s_at" ,"224916_at" ,"240176_at" ,"209626_s_at" ,"225239_at" ,"224929_at" ,"205802_at" ,"205648_at" ,"201954_at"
              ,"227126_at" ,"230387_at" ,"201315_x_at" ,"219032_x_at" ,"224772_at" ,"213241_at" ,"232914_s_at" ,"225782_at" ,"200788_s_at" ,"226677_at" ,"209758_s_at" ,"228531_at" ,"225496_s_at" ,"202437_s_at" ,"202052_s_at"
              ,"225242_s_at" ,"218627_at" ,"228827_at" ,"213113_s_at" ,"241916_at" ,"228946_at" ,"227370_at" ,"216950_s_at" ,"202686_s_at" ,"213994_s_at" ,"225442_at" ,"219594_at" ,"205173_x_at" ,"242558_at" ,"225056_at"
              ,"212917_x_at" ,"1555564_a_at" ,"228365_at" ,"205803_s_at" ,"212419_at" ,"211744_s_at" ,"204298_s_at" ,"202286_s_at" ,"226069_at" ,"228843_at" ,"222111_at" ,"226279_at" ,"203510_at" ,"219655_at" ,"204083_s_at"
              ,"202446_s_at" ,"202436_s_at" ,"203854_at" ,"226047_at" ,"200974_at" ,"212639_x_at" ,"222651_s_at" ,"219789_at" ,"203876_s_at" ,"227376_at" ,"202006_at" ,"227062_at" ,"202604_x_at" ,"212334_at" ,"202510_s_at"
              ,"205786_s_at" ,"203044_at" ,"223484_at" ,"227801_at" ,"212799_at" ,"236251_at" ,"218468_s_at" ,"226663_at" ,"213425_at" ,"205168_at" ,"209526_s_at" ,"242228_at" ,"236313_at" ,"205116_at" ,"202897_at"
              ,"202202_s_at" ,"235046_at" ,"204976_s_at" ,"209780_at" ,"229225_at" ,"218589_at" ,"205997_at" ,"211058_x_at" ,"213797_at" ,"228608_at" ,"204714_s_at" ,"1554168_a_at" ,"207517_at" ,"209949_at" ,"218400_at"
              ,"200600_at" ,"201888_s_at" ,"1553275_s_at" ,"226348_at" ,"212918_at" ,"236322_at" ,"218854_at" ,"213646_x_at" ,"200859_x_at" ,"222662_at" ,"205044_at" ,"234103_at" ,"224595_at" ,"229265_at" ,"205729_at"
              ,"203726_s_at" ,"220658_s_at" ,"227561_at" ,"1553117_a_at" ,"225018_at" ,"204672_s_at" ,"202457_s_at" ,"222803_at" ,"225045_at" ,"1556935_at" ,"200801_x_at" ,"228095_at" ,"203256_at" ,"205366_s_at" ,"212573_at"
              ,"213139_at" ,"209627_s_at" ,"211003_x_at" ,"225380_at" ,"202043_s_at" ,"214366_s_at" ,"213800_at" ,"211072_x_at" ,"200787_s_at" ,"228584_at" ,"231779_at" ,"209656_s_at" ,"201149_s_at" ,"235952_at"
              ,"213798_s_at" ,"208966_x_at" ,"215617_at" ,"231956_at" ,"225269_s_at" ,"201876_at" ,"222409_at" ,"216942_s_at" ,"213867_x_at" ,"227367_at" ,"201287_s_at" ,"244780_at" ,"219684_at" ,"209395_at" ,"210139_s_at"
              ,"226534_at" ,"225790_at" ,"205528_s_at" ,"228396_at" ,"202598_at" ,"202180_s_at" ,"230875_s_at" ,"1570259_at" ,"213746_s_at" ,"210117_at" ,"203741_s_at" ,"213725_x_at" ,"209960_at" ,"233587_s_at" ,"220356_at"
              ,"205249_at" ,"204400_at" ,"204990_s_at" ,"224594_x_at" ,"222572_at" ,"212657_s_at" ,"233690_at" ,"228335_at" ,"202435_s_at" ,"228785_at" ,"240861_at" ,"204362_at" ,"223028_s_at" ,"223380_s_at" ,"201474_s_at"
              ,"213532_at" ,"203788_s_at" ,"219778_at" ,"225129_at" ,"203140_at" ,"200916_at" ,"236738_at" ,"202071_at" ,"209576_at" ,"213428_s_at" ,"212632_at" ,"223374_s_at" ,"232797_at" ,"221676_s_at" ,"201920_at"
              ,"227449_at" ,"218469_at" ,"216693_x_at" ,"226347_at" ,"201090_x_at" ,"200808_s_at" ,"228121_at" ,"212531_at" ,"208703_s_at" ,"215903_s_at" ,"203748_x_at" ,"227013_at" ,"203477_at" ,"225033_at" ,"228585_at"
              ,"203085_s_at" ,"1555229_a_at" ,"225639_at" ,"221935_s_at" ,"231213_at" ,"223176_at" ,"242598_at" ,"227236_at" ,"224955_at" ,"235408_x_at" ,"225929_s_at" ,"210875_s_at" ,"207996_s_at" ,"204446_s_at" ,"203553_s_at"
              ,"230422_at" ,"204924_at" ,"219580_s_at" ,"203231_s_at" ,"229504_at" ,"203502_at" ,"206070_s_at" ,"238593_at" ,"212959_s_at" ,"206332_s_at" ,"201150_s_at" ,"235229_at" ,"202620_s_at" ,"210933_s_at" ,"212297_at"
              ,"201163_s_at" ,"211075_s_at" ,"223393_s_at" ,"203892_at" ,"210992_x_at" ,"212647_at" ,"204337_at" ,"237411_at" ,"244455_at" ,"226464_at" ,"204363_at" ,"205990_s_at" ,"219648_at" ,"1570165_at" ,"205547_s_at"
              ,"204749_at" ,"227514_at" ,"202566_s_at" ,"207808_s_at" ,"213793_s_at" ,"223949_at" ,"207992_s_at" ,"221698_s_at" ,"244356_at" ,"213943_at" ,"225646_at" ,"231726_at" ,"243409_at" ,"202968_s_at" ,"221773_at"
              ,"201189_s_at" ,"203757_s_at" ,"212609_s_at" ,"201058_s_at" ,"219540_at" ,"1555136_at" ,"226077_at" ,"202803_s_at" ,"208451_s_at" ,"201422_at" ,"210519_s_at" ,"204361_s_at" ,"214752_x_at" ,"1568574_x_at"
              ,"204472_at" ,"209270_at" ,"208789_at" ,"227998_at" ,"205071_x_at" ,"220301_at" ,"238447_at" ,"230640_at" ,"201108_s_at" ,"200625_s_at" ,"218401_s_at" ,"201925_s_at" ,"228740_at" ,"201809_s_at" ,"228948_at"
              ,"228299_at" ,"214845_s_at" ,"213993_at" ,"226837_at" ,"201560_at" ,"229947_at" ,"226757_at" ,"226795_at" ,"211395_x_at" ,"226350_at" ,"240304_s_at" ,"202291_s_at" ,"201631_s_at" ,"212651_at" ,"242699_at"
              ,"232544_at" ,"220988_s_at" ,"207266_x_at" ,"204679_at" ,"227620_at" ,"212650_at" ,"226725_at" ,"212501_at" ,"200762_at" ,"224374_s_at" ,"202948_at" ,"220955_x_at" ,"222348_at" ,"212386_at" ,"203688_at"
              ,"242396_at" ,"224791_at" ,"230229_at" ,"219054_at" ,"216899_s_at" ,"225367_at" ,"210830_s_at" ,"224796_at" ,"1568955_at" ,"201601_x_at" ,"AFFX-HSAC07/X00351_3_at" ,"223679_at" ,"225717_at" ,"221541_at"
              ,"229285_at" ,"213909_at" ,"213764_s_at" ,"210889_s_at" ,"213154_s_at" ,"208084_at" ,"219181_at" ,"226743_at" ,"225355_at" ,"225366_at" ,"218986_s_at" ,"213765_at" ,"204780_s_at" ,"200931_s_at" ,"226568_at"
              ,"213817_at" ,"217757_at" ,"201667_at" ,"226769_at" ,"227688_at" ,"218574_s_at" ,"235746_s_at" ,"202086_at" ,"219386_s_at" ,"204475_at" ,"205076_s_at" ,"213238_at" ,"210592_s_at" ,"225188_at" ,"201231_s_at"
              ,"228923_at" ,"212387_at" ,"228772_at" ,"212813_at" ,"239809_at" ,"212012_at" ,"221485_at" ,"238029_s_at" ,"214920_at" ,"213790_at" ,"204971_at" ,"227623_at" ,"227253_at" ,"212646_at" ,"212702_s_at"
              ,"218773_s_at" ,"203382_s_at" ,"211896_s_at" ,"205666_at" ,"222396_at" ,"219691_at" ,"208949_s_at" ,"231775_at" ,"221039_s_at" ,"212298_at" ,"203693_s_at" ,"219947_at" ,"207826_s_at" ,"205501_at" ,"222877_at"
              ,"244056_at" ,"204715_at" ,"203504_s_at" ,"205927_s_at" ,"203753_at" ,"202988_s_at" ,"209909_s_at" ,"210663_s_at" ,"202668_at" ,"204416_x_at" ,"1554452_a_at" ,"212599_at" ,"222418_s_at" ,"200832_s_at"
              ,"227452_at" ,"215127_s_at" ,"211657_at" ,"225651_at" ,"211506_s_at" ,"1555724_s_at" ,"209436_at" ,"213413_at" ,"208788_at" ,"227692_at" ,"213411_at" ,"243931_at" ,"203381_s_at" ,"227379_at" ,"205943_at"
              ,"202952_s_at" ,"200644_at" ,"209417_s_at" ,"211026_s_at" ,"219908_at" ,"215719_x_at" ,"204653_at" ,"209868_s_at" ,"223253_at" ,"202369_s_at" ,"215813_s_at" ,"215009_s_at" ,"218728_s_at" ,"225613_at" ,"235458_at"
              ,"202191_s_at" ,"203131_at" ,"208988_at" ,"201743_at" ,"214428_x_at" ,"201286_at" ,"201721_s_at" ,"209493_at" ,"203706_s_at" ,"211986_at" ,"224414_s_at" ,"1558680_s_at" ,"212263_at" ,"202479_s_at" ,"213519_s_at"
              ,"214803_at" ,"220088_at" ,"208965_s_at" ,"202565_s_at" ,"218802_at" ,"219492_at" ,"238542_at" ,"201015_s_at" ,"202800_at" ,"217028_at" ,"239272_at" ,"202133_at" ,"209682_at" ,"226932_at" ,"201110_s_at"
              ,"204612_at" ,"204790_at" ,"213566_at" ,"227609_at" ,"201843_s_at" ,"226203_at" ,"225968_at" ,"201893_x_at" ,"213684_s_at" ,"206584_at" ,"242234_at" ,"223501_at" ,"201926_s_at" ,"210895_s_at" ,"220918_at"
              ,"225016_at" ,"219506_at" ,"209583_s_at" ,"202609_at" ,"210719_s_at" ,"203820_s_at" ,"209321_s_at" ,"209906_at" ,"201088_at" ,"216834_at" ,"230000_at" ,"226416_at" ,"243149_at" ,"225611_at" ,"228776_at"
              ,"212372_at" ,"1555950_a_at" ,"238017_at" ,"218404_at" ,"204823_at" ,"235352_at" ,"226756_at" ,"233109_at" ,"227812_at" ,"208396_s_at" ,"238769_at" ,"202391_at" ,"231697_s_at" ,"202422_s_at" ,"206133_at"
              ,"214684_at" ,"211764_s_at" ,"213891_s_at" ,"60474_at" ,"227897_at" ,"223492_s_at" ,"1569652_at" ,"218472_s_at" ,"204614_at" ,"204006_s_at" ,"215101_s_at" ,"224917_at" ,"225189_s_at" ,"201250_s_at" ,"219666_at"
              ,"212385_at" ,"244548_at" ,"226142_at" ,"210423_s_at" ,"204162_at" ,"217755_at" ,"205349_at" ,"204201_s_at" ,"205081_at" ,"222146_s_at" ,"217430_x_at" ,"203882_at" ,"235911_at" ,"204994_at" ,"226560_at"
              ,"225842_at" ,"1555349_a_at" ,"208978_at" ,"209882_at" ,"237491_at" ,"214660_at" ,"1558034_s_at" ,"225673_at" ,"226825_s_at" ,"223502_s_at" ,"228109_at" ,"207198_s_at" ,"214085_x_at" ,"208268_at" ,"223077_at"
              ,"204122_at" ,"212382_at" ,"219602_s_at" ,"216840_s_at" ,"244050_at" ,"214022_s_at" ,"232164_s_at" ,"241864_x_at" ,"204339_s_at" ,"205518_s_at" ,"207850_at" ,"201719_s_at" ,"216915_s_at" ,"212585_at")
results <- getBM(attributes=c('affy_hg_u133_plus_2', 'entrezgene', 'hgnc_symbol'), filters = 'affy_hg_u133_plus_2', values = affyids, mart = ensembl) #Mapping the DE probes to HGNC symbols
View(results)
write.csv(results, file="ups.csv")
affyids = c("214116_at" ,"219076_s_at" ,"222102_at" ,"221590_s_at" ,"212886_at" ,"220306_at" ,"210165_at" ,"232245_at" ,"1562406_at" ,"214156_at" ,"228469_at" ,"56256_at","214117_s_at" ,"229544_at" ,"237017_s_at" ,"209368_at" ,
            "206085_s_at" ,"231452_at" ,"218025_s_at" ,"208056_s_at" ,"219118_at" ,"231667_at" ,"239765_at" ,"221067_s_at" ,"202017_at","204897_at" ,"226811_at" ,"231050_at" ,"219937_at" ,"210401_at" ,"396_f_at" ,"219117_s_at" ,
            "205412_at" ,"223715_at" ,"214142_at" ,"223426_s_at" ,"1564317_at" ,"215687_x_at","242308_at" ,"241017_at" ,"1552354_at" ,"1563498_s_at" ,"236677_at" ,"1554182_at" ,"1552281_at" ,"227629_at" ,"1553131_a_at" ,
            "1559633_a_at" ,"221868_at" ,"208450_at","202730_s_at" ,"206527_at" ,"217040_x_at" ,"223299_at" ,"205500_at" ,"235708_at" ,"220892_s_at")
getBM(attributes=c('affy_hg_u133_plus_2', 'entrezgene', 'hgnc_symbol'), filters = 'affy_hg_u133_plus_2', values = affyids, mart = ensembl)